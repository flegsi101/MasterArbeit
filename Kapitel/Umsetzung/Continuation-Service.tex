\section{Continuation-Service}

Der Continuation-Service ist ein einzelner Prozess.
In einer Schleife werden erst alle Datenquellen überprüft, die eine Zeitsteuerung enthalten.
Im zweiten Schritt werden alle Datenquellen mit Datenströmen geprüft.
Dabei wird die Schleife maximal einmal jede Minute durchlaufen, da über die Zeitsteuerung keine schneller Ausführung möglich ist.
In \cref{algo:ci-loop} ist die Logik eines Durchlaufes zu sehen.

\begin{algorithm}
\caption{Continuation loop}
\label{algo:ci-loop}
loopStart $\gets$ now \
checkSources $\gets$ query datasource with timers \
\ForAll {sources in checkSources} {
    timers $\gets$ timers of source \
    \ForAll {timer in timers} {
        \If {timer is now} {
            \If {source is not running} {
                send run event \
            }
        }
    }
}
looEnd $\gets$ now \
loopDuration $\gets$ loopEnd - loopStart \
\If {loopDuration $<$ 60 sec} {
    sleep for 60 sec - loopDuration \
}

\end{algorithm}

